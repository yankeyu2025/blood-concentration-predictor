# 血药浓度预测系统 - 云端部署指南

本指南将帮助您将血药浓度预测Web应用部署到云端，让全世界的用户都能访问。

## 🚀 推荐的部署平台

### 1. Railway (推荐) ⭐⭐⭐⭐⭐
- **优点**: 免费额度充足，部署简单，支持GitHub自动部署
- **免费额度**: 每月500小时运行时间
- **部署时间**: 5-10分钟

### 2. Render ⭐⭐⭐⭐
- **优点**: 完全免费，自动SSL证书，支持自定义域名
- **缺点**: 免费版有休眠机制
- **部署时间**: 10-15分钟

### 3. Heroku ⭐⭐⭐
- **优点**: 老牌平台，文档完善
- **缺点**: 2022年后不再提供免费服务
- **费用**: 最低$5/月

## 📋 部署前准备

### 必需文件清单 ✅
- [x] `web_app.py` - 主应用文件
- [x] `requirements.txt` - 依赖包列表
- [x] `Procfile` - 进程配置文件
- [x] `runtime.txt` - Python版本指定
- [x] `templates/` - HTML模板文件夹
- [x] `web_models/` - 模型文件夹
- [x] `.gitignore` - Git忽略文件
- [x] `app.json` - Heroku配置文件

## 🔧 Railway 部署步骤 (推荐)

### 第一步：准备GitHub仓库
1. 在GitHub上创建新仓库
2. 将项目文件上传到仓库
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/你的用户名/血药浓度预测.git
git push -u origin main
```

### 第二步：Railway部署
1. 访问 [Railway.app](https://railway.app)
2. 使用GitHub账号登录
3. 点击 "New Project" → "Deploy from GitHub repo"
4. 选择你的仓库
5. Railway会自动检测Python项目并开始部署
6. 等待部署完成（约5-10分钟）
7. 获取公网访问地址

### 第三步：配置自定义域名（可选）
1. 在Railway项目设置中添加自定义域名
2. 配置DNS记录指向Railway提供的地址

## 🌐 Render 部署步骤

### 第一步：创建Render账号
1. 访问 [Render.com](https://render.com)
2. 使用GitHub账号注册登录

### 第二步：创建Web Service
1. 点击 "New" → "Web Service"
2. 连接GitHub仓库
3. 配置部署设置：
   - **Name**: 血药浓度预测系统
   - **Environment**: Python 3
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `python web_app.py`
4. 点击 "Create Web Service"
5. 等待部署完成

## 💡 Heroku 部署步骤

### 第一步：安装Heroku CLI
```bash
# Windows
winget install Heroku.CLI

# macOS
brew tap heroku/brew && brew install heroku
```

### 第二步：登录并创建应用
```bash
heroku login
heroku create 你的应用名称
```

### 第三步：部署应用
```bash
git add .
git commit -m "Deploy to Heroku"
git push heroku main
```

## 🔍 部署后验证

### 检查清单
- [ ] 网站能正常访问
- [ ] 预测功能正常工作
- [ ] 所有页面样式正确显示
- [ ] 模型加载成功
- [ ] 输入验证正常工作

### 测试数据
使用以下测试数据验证系统：
- 日剂量: 2.5
- CLCR: 85.0
- GGT: 45.0
- Na: 140.0
- HDL-C: 1.2
- ALB: 42.0

## 🛠️ 常见问题解决

### 1. 模型文件过大
如果模型文件超过平台限制，可以考虑：
- 使用Git LFS存储大文件
- 压缩模型文件
- 使用云存储服务

### 2. 内存不足
免费版平台通常有内存限制：
- 优化模型加载方式
- 减少不必要的依赖包
- 使用更轻量的模型格式

### 3. 启动超时
如果应用启动时间过长：
- 优化模型加载逻辑
- 使用异步加载
- 增加启动超时时间设置

## 📊 性能优化建议

### 1. 缓存优化
```python
from functools import lru_cache

@lru_cache(maxsize=128)
def load_model():
    # 缓存模型加载
    pass
```

### 2. 静态文件CDN
使用CDN加速Bootstrap和其他静态资源加载

### 3. 数据库优化
如需存储预测历史，建议使用轻量级数据库如SQLite

## 🔒 安全考虑

### 1. 环境变量
敏感配置使用环境变量：
```python
import os
SECRET_KEY = os.environ.get('SECRET_KEY', 'default-key')
```

### 2. 输入验证
确保所有用户输入都经过严格验证

### 3. HTTPS
生产环境必须使用HTTPS加密

## 📈 监控和维护

### 1. 日志监控
- 设置应用日志记录
- 监控错误和异常
- 定期检查性能指标

### 2. 定期更新
- 定期更新依赖包
- 监控安全漏洞
- 备份重要数据

## 🎯 下一步计划

1. **用户反馈系统** - 收集医生使用反馈
2. **预测历史记录** - 存储和查看历史预测
3. **多语言支持** - 支持英文等其他语言
4. **移动端优化** - 改善手机端用户体验
5. **API接口** - 提供RESTful API供其他系统调用

## 📞 技术支持

如果在部署过程中遇到问题，可以：
1. 查看平台官方文档
2. 检查应用日志
3. 联系技术支持团队

---

**祝您部署成功！让更多医生受益于这个智能预测系统！** 🎉